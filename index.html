
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
        <link rel="next" href="step/">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.3">
    
    
      
        <title>Datarails Documentation</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.c4a75a56.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#datarails-a-simple-lightweight-framework-for-dataframe-etl" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Datarails Documentation" class="md-header__button md-logo" aria-label="Datarails Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Datarails Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Home
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Datarails Documentation" class="md-nav__button md-logo" aria-label="Datarails Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Datarails Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        Home
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#-version-032-" class="md-nav__link">
    -- VERSION 0.3.2 --
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#official-documentation" class="md-nav__link">
    Official Documentation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#features" class="md-nav__link">
    Features
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-example" class="md-nav__link">
    Simple Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-project" class="md-nav__link">
    Example Project
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-use-datarails" class="md-nav__link">
    Why Use DataRails?
  </a>
  
    <nav class="md-nav" aria-label="Why Use DataRails?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-segmenting-your-etl-job-into-manageable-steps" class="md-nav__link">
    1. Segmenting Your ETL Job into Manageable Steps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-navigating-your-etl-job-step-by-step" class="md-nav__link">
    2. Navigating Your ETL Job Step by Step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-a-practical-solution-for-typical-data-sizes" class="md-nav__link">
    3. A Practical Solution for Typical Data Sizes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-simplified-documentation" class="md-nav__link">
    4. Simplified Documentation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-facilitating-standardization-across-the-organization" class="md-nav__link">
    5. Facilitating Standardization Across the Organization
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="step/" class="md-nav__link">
        DataRailsStep
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="runner/" class="md-nav__link">
        StepRunner
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="databox/" class="md-nav__link">
        DataBox
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="context/" class="md-nav__link">
        DataRailsContext
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#-version-032-" class="md-nav__link">
    -- VERSION 0.3.2 --
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#official-documentation" class="md-nav__link">
    Official Documentation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#features" class="md-nav__link">
    Features
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-example" class="md-nav__link">
    Simple Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-project" class="md-nav__link">
    Example Project
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-use-datarails" class="md-nav__link">
    Why Use DataRails?
  </a>
  
    <nav class="md-nav" aria-label="Why Use DataRails?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-segmenting-your-etl-job-into-manageable-steps" class="md-nav__link">
    1. Segmenting Your ETL Job into Manageable Steps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-navigating-your-etl-job-step-by-step" class="md-nav__link">
    2. Navigating Your ETL Job Step by Step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-a-practical-solution-for-typical-data-sizes" class="md-nav__link">
    3. A Practical Solution for Typical Data Sizes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-simplified-documentation" class="md-nav__link">
    4. Simplified Documentation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-facilitating-standardization-across-the-organization" class="md-nav__link">
    5. Facilitating Standardization Across the Organization
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<p><a href="https://github.com/JesseMaitland/datarails/actions/workflows/release.yml"><img alt="Release python package" src="https://github.com/JesseMaitland/datarails/actions/workflows/release.yml/badge.svg" /></a></p>
<h1 id="datarails-a-simple-lightweight-framework-for-dataframe-etl">datarails -- A Simple, Lightweight Framework for Dataframe ETL</h1>
<h4 id="-version-032-">-- VERSION 0.3.2 --</h4>
<p>Datarails is a simple framework for organizing your in memory Dataframe based ETL jobs. It doesn't matter of you are using <code>pandas</code>, <code>spark</code>, <code>glue</code> or anything else
this library serves as a simple way to structure your ETL jobs. It is not a replacement for <code>airflow</code>, <code>luigi</code>, <code>dagster</code> or any other workflow management tool, but rather
can serve as the "entry point" for your workflow management tool to execute your ETL job.</p>
<h2 id="official-documentation">Official Documentation</h2>
<p>The official documentation is hosted on github pages at <a href="https://jessemaitland.github.io/datarails/">jesse.maitland.github.io</a></p>
<h2 id="installation">Installation</h2>
<p>Datarails is available on PyPI and can be installed with pip. It has no dependencies and is written in pure python.</p>
<pre><code class="language-bash">pip install datarails
</code></pre>
<h2 id="features">Features</h2>
<p>Datarails consists of 4 main classes:</p>
<p><strong>DataBox:</strong> A dynamic data store for DataFrame objects. It can handle any DataFrame type, and offers methods for adding, retrieving, and removing data. It's a bit like a dictionary for DataFrames.</p>
<p><strong>DataRailsContext:</strong> A companion to DataBox, this class is designed for storing and retrieving additional data that you may need alongside your DataFrame objects. It allows you to associate metadata, configuration details, and other supplementary information with your data.</p>
<p><strong>DataRailsStepRunner:</strong> This class is responsible for running a sequence of DataRailsStep objects. It takes a DataBox as input and manages the execution of each step, tracking the state of the DataBox as it goes.</p>
<p><strong>DataRailsStep:</strong> A base class for defining steps in your data pipeline. By inheriting from this class, you can create custom steps that fit your specific needs.</p>
<h2 id="simple-example">Simple Example</h2>
<p>ETL steps are defined as classes and then passed to a step runner. All methods in the class that start with <code>step_</code> will be run in the order they are defined.
Each step has access to a <code>DataBox</code> object that can be used to store dataframes and access them by name in downstream steps.</p>
<p>In addition to the <code>DataBox</code> object, each step has access to a <code>DataRailsContext</code> object that can be used to store and access variables that are not dataframes.</p>
<p>In this below example we are doing some simple procssing using pandas, however any other dataframe library could be used.</p>
<pre><code class="language-python">import pandas as pd
from datarails.step import DataRailsStep
from datarails.runner import DataRailsStepRunner


class LoadDataFromCSV(DataRailsStep):
    &quot;&quot;&quot;Loads data from a CSV file into a DataBox.&quot;&quot;&quot;

    def step_load_csv(self) -&gt; None:
        &quot;&quot;&quot;Loads a DataFrame from a CSV file and stores it in the DataBox under 'data'.&quot;&quot;&quot;
        print('loading data from csv')
        df = pd.read_csv('data.csv')
        self.dbx.put_df('data', df)


class TransformData(DataRailsStep):
    &quot;&quot;&quot;Applies transformation operations to a DataFrame stored in a DataBox.&quot;&quot;&quot;

    def step_add_new_column(self) -&gt; None:
        &quot;&quot;&quot;Adds a new column to the DataFrame which is double the values of the 'old_column'.&quot;&quot;&quot;
        print('adding new column')
        self.dbx.data['new_column'] = self.dbx.data['old_column'] * 2

    def step_drop_all_null_rows(self) -&gt; None:
        &quot;&quot;&quot;Removes all rows from the DataFrame that contain any null values.&quot;&quot;&quot;
        print('dropping null rows')
        self.dbx.data = self.dbx.data.dropna()

    def step_rename_columns(self) -&gt; None:
        &quot;&quot;&quot;Renames the 'new_column' in the DataFrame to 'blue_column'.&quot;&quot;&quot;
        print('renaming columns')
        self.dbx.data = self.dbx.data.rename(columns={'new_column': 'blue_column'})


class SaveData(DataRailsStep):
    &quot;&quot;&quot;Saves the DataFrame from a DataBox to a CSV file.&quot;&quot;&quot;

    def step_save_data(self) -&gt; None:
        &quot;&quot;&quot;Saves the DataFrame to a CSV file named 'new_data.csv'.&quot;&quot;&quot;
        print('saving data')
        self.dbx.data.to_csv('new_data.csv')


# gather your steps in a list of class definitions. The class instances will be created by the step runner
# while the jobs is being executed.
steps = [
    LoadDataFromCSV,
    TransformData,
    SaveData
]

# pass your steps to the step runner
runner = DataRailsStepRunner(steps=steps)

# Run the job. The steps will be run in the order they are defined in the list. Each method declared in a step will be
# executed in the order they are defined in the class.

if __name__ == '__main__':
    runner.run()

</code></pre>
<h2 id="example-project">Example Project</h2>
<p>There is an example repo containing some simple ETL jobs, notebooks and commands for building documentation at <a href="https://github.com/JesseMaitland/datarails_examples">jessemaitland/datarails-example</a></p>
<h2 id="why-use-datarails">Why Use DataRails?</h2>
<p><code>datarails</code> addresses several critical issues commonly encountered during the execution of small to medium scale ETL (Extract, Transform, Load) scripts in Python. While simple, it is an effective framework that streamlines ETL tasks, and serves as a robust "entry point" for other workflow management tools, like <code>airflow</code>, <code>luigi</code>, or <code>dagster</code>, to execute your ETL job.</p>
<h3 id="1-segmenting-your-etl-job-into-manageable-steps">1. Segmenting Your ETL Job into Manageable Steps</h3>
<p>ETL tasks of small or medium complexity can often transform into a single, monolithic script. While functional, this approach could be challenging to debug when data-related errors occur. <code>datarails</code> allows the segmentation of ETL tasks into distinct, manageable steps, enhancing clarity and error-handling.</p>
<h3 id="2-navigating-your-etl-job-step-by-step">2. Navigating Your ETL Job Step by Step</h3>
<p>With <code>datarails</code>, it's possible to debug ETL jobs step-by-step. You can import your runner into a Python shell or a Jupyter notebook, advancing through each step individually. This method is particularly beneficial when working with schema-less source data formats like JSON or CSV, enabling precise data inspection at every stage.</p>
<pre><code class="language-python">from my_etl_job import runner
runner.advance() # run the next step and stop execution

step_to_debug = runner.get_current_step() # get the current step

step_to_debug.dbx.data # inspect the data in the DataBox
step_to_debug.dbx.context # inspect the context in the DataRailsContext

step_to_debug.advance() # run the next step and stop execution. Repeat as needed.
</code></pre>
<h3 id="3-a-practical-solution-for-typical-data-sizes">3. A Practical Solution for Typical Data Sizes</h3>
<p>Most often, external processes fetch data and upload it into S3 (or similar cloud storage) on a daily basis. The data, typically in the size range of 20MB to 100MB and in diverse formats like <code>json</code>, <code>json lines</code>, or <code>csv</code>, needs transformation and cleaning before it can be utilized by other teams in your data lake or warehouse. <code>datarails</code> is an ideal library for managing and transforming these types of data.</p>
<h3 id="4-simplified-documentation">4. Simplified Documentation</h3>
<p><code>datarails</code> encourages the practice of dividing ETL jobs into smaller methods, thus facilitating the process of documentation. This feature works well with Python's native tools for generating documentation from docstrings, and such documentation can be published through your CI job. This way, it is readily available for business users or other technical users, significantly reducing the time you spend responding to queries about your ETL jobs.</p>
<h3 id="5-facilitating-standardization-across-the-organization">5. Facilitating Standardization Across the Organization</h3>
<p>In many organizations, ETL processes and data pipelines can be constructed in vastly different ways depending on the preferences and experience of individual developers. This can lead to considerable confusion, difficulty in maintaining code, and barriers to effective collaboration. <code>datarails</code> can help overcome these challenges by offering a standard framework for developing ETL jobs.</p>
<p>The use of <code>datarails</code> ensures that all ETL scripts follow the same structure and approach, creating a uniform coding style across the organization. This not only makes the codebase easier to understand and maintain, but also encourages effective collaboration between team members. Moreover, the standardized structure can expedite the onboarding process for new team members, as they only need to familiarize themselves with one framework, rather than a multitude of disparate coding styles.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": ".", "features": ["content.code.copy"], "search": "assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.efa0ade1.min.js"></script>
      
    
  </body>
</html>